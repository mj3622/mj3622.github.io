---
title: Python è‡ªåŠ¨åŒ–å®æˆ˜ï¼šä»é›¶ç¼–å†™æ»´ç­”æ¸…å•ä»»åŠ¡åˆ›å»ºå·¥å…·
published: 2026-02-25
description: åœ¨æ—¥å¸¸å·¥ä½œå’Œå­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬æ—¶å¸¸è¦æŠŠæŠ¥é”™æ—¥å¿—ã€å®šæ—¶æé†’ã€é‚®ä»¶å¾…åŠç­‰åˆ†æ•£ä¿¡æ¯æ”¶æ‹¢ç»Ÿä¸€ç®¡ç†ã€‚æ»´ç­”æ¸…å•ï¼ˆDida365/TickTickï¼‰ä½œä¸ºä¼˜ç§€çš„ GTD å·¥å…·ï¼Œå®˜æ–¹æä¾›äº† Open APIï¼Œä¾¿äºç›´æ¥è‡ªåŠ¨åŒ–æ¥å…¥ã€‚
tags: [Python, è‡ªåŠ¨åŒ–, å·¥å…·]
category: ç»éªŒåˆ†äº«
draft: false
---
åœ¨æ—¥å¸¸å·¥ä½œå’Œå­¦ä¹ ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸éœ€è¦å°†å„ä¸ªå¹³å°äº§ç”Ÿçš„ä¿¡æ¯ï¼ˆå¦‚æŠ¥é”™æ—¥å¿—ã€å®šæ—¶æé†’ã€é‚®ä»¶å¾…åŠï¼‰æ±‡æ€»åˆ°ä¸€å¤„è¿›è¡Œç®¡ç†ã€‚æ»´ç­”æ¸…å•ï¼ˆDida365/TickTickï¼‰ä½œä¸ºä¸€æ¬¾ä¼˜ç§€çš„ GTD å·¥å…·ï¼Œå®˜æ–¹æä¾›äº† Open API ä¾›å¼€å‘è€…æ¥å…¥ã€‚

æœ¬æ–‡å°†æ‰‹æŠŠæ‰‹å¸¦ä½ ä»é›¶å¼€å§‹ï¼Œä½¿ç”¨ Python ç¼–å†™ä¸€ä¸ªæ”¯æŒå‘½ä»¤è¡Œä¼ å‚ã€å…·å¤‡å¤±è´¥é‡è¯•å’Œé£ä¹¦å‘Šè­¦å…œåº•æœºåˆ¶çš„æ»´ç­”æ¸…å•è‡ªåŠ¨åˆ›å»ºä»»åŠ¡å·¥å…·ã€‚

# å‡†å¤‡å·¥ä½œï¼šè·å– API å‡­è¯

åœ¨ç¼–å†™ä»£ç ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦åœ¨æ»´ç­”æ¸…å•å¼€å‘è€…å¹³å°æ³¨å†Œåº”ç”¨ï¼Œä»¥è·å–è°ƒç”¨ API çš„é’¥åŒ™ã€‚

1. ç™»å½• [æ»´ç­”æ¸…å•å¼€å‘è€…ä¸­å¿ƒ](https://developer.dida365.com/manage)ã€‚
2. åˆ›å»ºä¸€ä¸ªæ–°çš„åº”ç”¨ï¼ˆAppï¼‰ï¼Œåç§°éšæ„å¡«ï¼Œæ¯”å¦‚ `MyAutoTask`ã€‚
3. åœ¨åº”ç”¨è¯¦æƒ…é¡µä¸­ï¼Œä½ ä¼šè·å¾—å…³é”®çš„ `Client ID` å’Œ `Client Secret`ã€‚åŒæ—¶ï¼Œåœ¨â€œOAuth Redirect URLâ€ä¸­å¡«å…¥ `http://127.0.0.1:8080`ï¼ˆç”¨äºæœ¬åœ°æµ‹è¯•çš„å›è°ƒï¼‰ã€‚

# ç¬¬ä¸€æ­¥ï¼šè·å– Access Token

æ»´ç­”æ¸…å•ä½¿ç”¨çš„æ˜¯æ ‡å‡† OAuth2 æˆæƒæœºåˆ¶ã€‚ä¸ºäº†è®©è‡ªåŠ¨åŒ–è„šæœ¬èƒ½å¤Ÿé•¿æœŸé™é»˜è¿è¡Œï¼Œæˆ‘ä»¬éœ€è¦è·å–ä¸€ä¸ªæˆæƒçš„ `Access Token`ã€‚æˆæƒåç›´æ¥é¢å‘çš„ Access Token å…·æœ‰æé•¿çš„æœ‰æ•ˆæœŸï¼Œç›´æ¥å°†å…¶å†™æ­»åœ¨è„šæœ¬ä¸­å³å¯ã€‚

**1. æ‹¼æ¥å¹¶è®¿é—®æˆæƒé“¾æ¥**
å°†ä½ çš„ `Client ID` æ›¿æ¢åˆ°ä»¥ä¸‹é“¾æ¥ä¸­ï¼Œå¹¶åœ¨æµè§ˆå™¨æ‰“å¼€ï¼š

```text
https://dida365.com/oauth/authorize?scope=tasks:write tasks:read&client_id=ä½ çš„ClientID&state=state&redirect_uri=http://127.0.0.1:8080&response_type=code

```

**2. è·å–æˆæƒ Code**
åœ¨å¼¹å‡ºçš„é¡µé¢ç‚¹å‡»â€œæˆæƒâ€åï¼Œæµè§ˆå™¨ä¼šè·³è½¬åˆ°ä¸€ä¸ªæ— æ³•è®¿é—®çš„æœ¬åœ°åœ°å€ã€‚ç›´æ¥çœ‹æµè§ˆå™¨åœ°å€æ ï¼š
`http://127.0.0.1:8080/?code=xxxxxx_ä½ çš„code_xxxxxx&state=state`
å¤åˆ¶å‡ºè¿™æ®µ `code`ï¼ˆæ³¨æ„å®ƒåªæœ‰å‡ åˆ†é’Ÿæœ‰æ•ˆæœŸä¸”ä»…èƒ½ä½¿ç”¨ä¸€æ¬¡ï¼‰ã€‚

**3. æ¢å– Token**
æ‰“å¼€ç»ˆç«¯ï¼Œä½¿ç”¨ `curl` å‘½ä»¤æ¢å– Tokenï¼ˆæ›¿æ¢ä¸ºä½ çš„ IDã€Secret å’Œ Codeï¼‰ï¼š

```bash
curl -X POST https://dida365.com/oauth/token \
-H "Content-Type: application/x-www-form-urlencoded" \
-d "client_id=ä½ çš„ClientID" \
-d "client_secret=ä½ çš„ClientSecret" \
-d "code=ä½ çš„Code" \
-d "grant_type=authorization_code" \
-d "scope=tasks:write tasks:read" \
-d "redirect_uri=http://127.0.0.1:8080"

```

æ‰§è¡Œåè¿”å›çš„ JSON æ•°æ®ä¸­ï¼Œæå–å‡º `access_token` çš„å€¼å¦¥å–„ä¿å­˜ã€‚

# ç¬¬äºŒæ­¥ï¼šè·å–ä»»åŠ¡æ¸…å• ID (Project ID)

åœ¨æ»´ç­”æ¸…å•ä¸­ï¼Œä»»åŠ¡é€šå¸¸å½’å±äºä¸åŒçš„â€œæ¸…å•â€ï¼ˆProjectï¼‰ã€‚ä¸ºäº†è®©è„šæœ¬å°†ä»»åŠ¡å‡†ç¡®æŠ•é€’åˆ°æŒ‡å®šæ¸…å•ï¼Œæˆ‘ä»¬éœ€è¦è·å–è¯¥æ¸…å•çš„ä¸“å± IDã€‚å¦‚æœä¸æŒ‡å®šï¼ŒAPI é»˜è®¤ä¼šå°†å…¶æ”¾å…¥â€œæ”¶é›†ç®±â€ã€‚

**æ–¹æ³•ä¸€ï¼šé€šè¿‡ç½‘é¡µç«¯å¼€å‘è€…å·¥å…·è·å–ï¼ˆæ¨èï¼‰**
è¿™æ˜¯æœ€ç›´è§‚çš„å…å†™ä»£ç è·å–æ–¹å¼ï¼š

1. ç™»å½•æ»´ç­”æ¸…å•ç½‘é¡µç«¯ã€‚
2. åœ¨å·¦ä¾§è¾¹æ ç‚¹å‡»è¿›å…¥ä½ æƒ³è¦å­˜æ”¾è‡ªåŠ¨åŒ–ä»»åŠ¡çš„æ¸…å•ã€‚
3. æŒ‰ `F12`ï¼ˆæˆ–å³é”®ç‚¹å‡»é¡µé¢é€‰æ‹©â€œæ£€æŸ¥â€ï¼‰æ‰“å¼€æµè§ˆå™¨çš„**å¼€å‘è€…å·¥å…·**ï¼Œå¹¶åˆ‡æ¢åˆ° **Networkï¼ˆç½‘ç»œï¼‰** é¢æ¿ã€‚
4. é‡æ–°åˆ·æ–°ç½‘é¡µï¼Œæ­¤æ—¶ Network é¢æ¿ä¸­ä¼šæŠ“å–åˆ°ç½‘ç»œè¯·æ±‚ã€‚ ç‚¹å‡»åç§°ä¸º `projects` çš„è¯·æ±‚ã€‚
5. åœ¨è¯¥è¯·æ±‚çš„ **Response** æ•°æ®ä¸­å¯»æ‰¾ `id` å­—æ®µã€‚å¤åˆ¶è¿™ä¸²å­—ç¬¦å¤‡ç”¨ã€‚
   ![1772031359244](image/æ»´ç­”æ¸…å•è‡ªåŠ¨åˆ›å»ºä»»åŠ¡/1772031359244.png)

**æ–¹æ³•äºŒï¼šé€šè¿‡å®˜æ–¹ API è·å–**
å¦‚æœä½ ç†Ÿæ‚‰æ¥å£è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è·å–åˆ°çš„ Access Tokenï¼Œç›´æ¥å‘å®˜æ–¹çš„è·å–æ¸…å•åˆ—è¡¨æ¥å£å‘é€ `GET` è¯·æ±‚ï¼ˆå¯¹åº” Endpoint ä¸º `/open/v1/project`ï¼‰ã€‚æ¥å£ä¼šè¿”å›ä½ è´¦æˆ·ä¸‹æ‰€æœ‰æ¸…å•çš„å®Œæ•´ JSON æ•°æ®ï¼Œä½ å¯ä»¥ä»ä¸­æå–æ‰€éœ€çš„ IDã€‚æ­¤å¤„ä¸ä½œè¯¦ç»†å±•å¼€ã€‚

# ç¬¬ä¸‰æ­¥ï¼šç¼–å†™æ ¸å¿ƒ Python è„šæœ¬

ç¡®ä¿ä½ çš„ç¯å¢ƒå·²å®‰è£… Python 3ï¼Œå¹¶å®‰è£… `requests` åº“ï¼š

```bash
pip3 install requests

```

æ–°å»ºä¸€ä¸ªåä¸º `create_dida_task.py` çš„æ–‡ä»¶ï¼Œå°†ä¸‹æ–¹ä»£ç ç²˜è´´è¿›å»ã€‚ä»£ç å†…ç½®äº†åŠ¨æ€ä¼ å‚ã€é‡è¯•æœºåˆ¶å’Œé£ä¹¦å…œåº•å‘Šè­¦ã€‚è¯·å°†å‰é¢è·å–åˆ°çš„ Token å’Œ Project ID å¡«å…¥ä»£ç çš„é…ç½®åŒºã€‚

```python
import argparse
import requests
import time
import logging
import json
import sys
from datetime import datetime, timedelta, timezone

# é…ç½®æ—¥å¿—è¾“å‡ºæ ¼å¼
logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[logging.StreamHandler(sys.stdout)]
)

# ================= é…ç½®åŒº =================
# å¡«å…¥ä½ è·å–çš„ Access Token
DIDA_TOKEN = "YOUR_ACCESS_TOKEN"

# é£ä¹¦å‘Šè­¦é…ç½® (å¦‚æœæš‚æ—¶ä¸ç”¨ï¼Œå¯ä»¥ç•™ç©º)
FEISHU_WEBHOOK = "YOUR_FEISHU_WEBHOOK_URL"

# å¡«å…¥æŠ“åŒ…è·å–çš„æ¸…å• ID
DEFAULT_PROJECT_ID = "YOUR_PROJECT_ID"
MAX_RETRIES = 3
# ==========================================

def get_task_dates(is_today_only=False):
    """è·å–ä»»åŠ¡çš„èµ·æ­¢ UTC æ—¶é—´å­—ç¬¦ä¸²"""
    now_utc = datetime.now(timezone.utc)
    start_date = now_utc.replace(hour=0, minute=0, second=0, microsecond=0)

    if is_today_only:
        due_date = start_date
    else:
        due_date = start_date + timedelta(days=2)

    time_format = "%Y-%m-%dT%H:%M:%S+0000"
    return start_date.strftime(time_format), due_date.strftime(time_format)

def send_feishu_alert(task_title, error_detail):
    """å‘é€é£ä¹¦å‘Šè­¦æ¨é€"""
    if not FEISHU_WEBHOOK or FEISHU_WEBHOOK == "YOUR_FEISHU_WEBHOOK_URL":
        logging.warning("æœªé…ç½®æœ‰æ•ˆçš„é£ä¹¦ Webhookï¼Œè·³è¿‡å‘Šè­¦ã€‚")
        return

    headers = {"Content-Type": "application/json"}
    payload = {
        "msg_type": "text",
        "content": {
            "text": f"ğŸš¨ æ»´ç­”æ¸…å•ä»»åŠ¡åˆ›å»ºå¤±è´¥\nä»»åŠ¡ï¼š{task_title}\né”™è¯¯ï¼š{error_detail}"
        }
    }
    try:
        requests.post(FEISHU_WEBHOOK, headers=headers, data=json.dumps(payload), timeout=10)
    except Exception as e:
        logging.error(f"é£ä¹¦å‘Šè­¦å¤±è´¥: {e}")

def create_dida_task(title, content, is_today, priority):
    """è°ƒç”¨ API åˆ›å»ºä»»åŠ¡"""
    url = "https://api.dida365.com/open/v1/task"
    headers = {
        "Authorization": f"Bearer {DIDA_TOKEN}",
        "Content-Type": "application/json"
    }

    start_date, due_date = get_task_dates(is_today)

    payload = {
        "title": title,
        "projectId": DEFAULT_PROJECT_ID,
        "isAllDay": True,
        "startDate": start_date,
        "dueDate": due_date,
        "priority": priority
    }
    if content:
        payload["content"] = content

    for attempt in range(1, MAX_RETRIES + 1):
        try:
            response = requests.post(url, headers=headers, json=payload, timeout=10)
            response.raise_for_status()
            logging.info(f"âœ… æˆåŠŸ: {title} (ä¼˜å…ˆçº§:{priority}, ä»…å½“å¤©:{is_today})")
            return True
        except requests.exceptions.RequestException as e:
            error_msg = f"{e} | {getattr(e.response, 'text', '')}"
            logging.warning(f"âŒ å¤±è´¥ ({attempt}/{MAX_RETRIES}): {error_msg}")

            if attempt < MAX_RETRIES:
                time.sleep(2 ** attempt)
            else:
                send_feishu_alert(title, error_msg)
                return False

if __name__ == "__main__":
    parser = argparse.ArgumentParser()
    parser.add_argument("--title", required=True)
    parser.add_argument("--content", default="")
    parser.add_argument("--today", action="store_true")
    parser.add_argument("--priority", type=int, choices=[0, 1, 3, 5], default=0)

    args = parser.parse_args()
    success = create_dida_task(args.title, args.content, args.today, args.priority)
    sys.exit(0 if success else 1)

```

# ç¬¬å››æ­¥ï¼šè¿è¡Œä¸æµ‹è¯•

è¿›å…¥è„šæœ¬æ‰€åœ¨ç›®å½•ï¼Œæ‰“å¼€ç»ˆç«¯è¿›è¡Œæµ‹è¯•ï¼š

**åˆ›å»ºåŸºç¡€ä»»åŠ¡ï¼š**

```bash
python3 create_dida_task.py --title "é˜…è¯»æ»´ç­”æ¸…å•APIæ–‡æ¡£"

```

**åˆ›å»ºé«˜ä¼˜å…ˆçº§ä¸”å¿…é¡»ä»Šæ—¥å®Œæˆçš„ä»»åŠ¡ï¼š**

```bash
python3 create_dida_task.py --title "å¤„ç†æœåŠ¡å™¨å®•æœº" --content "ç´§æ€¥æ’æŸ¥Nginxæ—¥å¿—" --today --priority 5

```

å¦‚æœè¿è¡ŒæˆåŠŸï¼Œä½ çš„æ»´ç­”æ¸…å•å¯¹åº”åˆ—è¡¨ä¸­å°±ä¼šç«‹åˆ»å‡ºç°è¿™ç¬”æ–°ä»»åŠ¡ã€‚

ä¸ºäº†ä¾¿äºåç»­æ¥å…¥ `crontab`ã€CI/CD æˆ–å‘Šè­¦è„šæœ¬ï¼Œå»ºè®®å…ˆç†Ÿæ‚‰è¿™å‡ ä¸ªå‘½ä»¤è¡Œå‚æ•°ï¼š

| å‚æ•°           | æ˜¯å¦å¿…å¡« | ç±»å‹ / å–å€¼                   | é»˜è®¤å€¼    | è¯´æ˜                                               | ç¤ºä¾‹                              |
| -------------- | -------- | ----------------------------- | --------- | -------------------------------------------------- | --------------------------------- |
| `--title`    | æ˜¯       | å­—ç¬¦ä¸²                        | æ—         | ä»»åŠ¡æ ‡é¢˜ï¼Œå»ºè®®ç®€æ´æ˜ç¡®ï¼Œä¾¿äºåˆ—è¡¨å¿«é€Ÿæ‰«æã€‚         | `--title "å¤„ç†æœåŠ¡å™¨å®•æœº"`      |
| `--content`  | å¦       | å­—ç¬¦ä¸²                        | `""`    | ä»»åŠ¡è¯¦æƒ…/å¤‡æ³¨ï¼Œå¯å†™æ’æŸ¥æ­¥éª¤ã€é“¾æ¥ã€ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚    | `--content "ç´§æ€¥æ’æŸ¥Nginxæ—¥å¿—"` |
| `--today`    | å¦       | å¸ƒå°”å¼€å…³ï¼ˆå‡ºç°å³ä¸º trueï¼‰     | `false` | æ ‡è®°åä»»åŠ¡ä»…å½“å¤©ï¼›ä¸åŠ æ—¶é»˜è®¤æˆªæ­¢æ—¥æœŸä¸ºä¸¤å¤©åã€‚     | `--today`                       |
| `--priority` | å¦       | æ•´æ•°ï¼š`0`/`1`/`3`/`5` | `0`     | ä»»åŠ¡ä¼˜å…ˆçº§ã€‚æ•°å€¼è¶Šé«˜è¶Šç´§æ€¥ï¼Œ`5` å¸¸ç”¨äºäº‹æ•…å¤„ç†ã€‚ | `--priority 5`                  |

ä½ å¯ä»¥æŠŠè¿™äº›å‚æ•°ç»„åˆä½¿ç”¨ï¼Œä¾‹å¦‚ï¼š

```bash
python3 create_dida_task.py \
  --title "ä¿®å¤çº¿ä¸Šå‘Šè­¦" \
  --content "å…ˆçœ‹ç›‘æ§é¢æ¿ï¼Œå†æ’æŸ¥è¿‘ 1 å°æ—¶å‘å¸ƒè®°å½•" \
  --today \
  --priority 5

```

å¦‚æœä½ åœ¨è‡ªåŠ¨åŒ–ç³»ç»Ÿé‡Œè°ƒç”¨è¯¥è„šæœ¬ï¼ˆå¦‚å®šæ—¶ä»»åŠ¡ã€å‘Šè­¦å›è°ƒï¼‰ï¼Œå»ºè®®è‡³å°‘ä¿è¯ `--title` å¯è¿½è¸ªä¸” `--priority` æœ‰æ˜ç¡®è§„åˆ™ï¼Œåç»­æ’æŸ¥ä¼šè½»æ¾å¾ˆå¤šã€‚

# å¯æ‹“å±•å†…å®¹ï¼ˆè¿›é˜¶ç©æ³•ï¼‰

æŒæ¡äº†åŸºç¡€çš„è„šæœ¬åï¼Œä½ å¯ä»¥å°†å…¶æ— ç¼æ¥å…¥æ›´å¤šè‡ªåŠ¨åŒ–åœºæ™¯ï¼š

1. **æœåŠ¡å™¨å®šæ—¶ç›‘æ§ä»»åŠ¡ç”Ÿæˆ**
   ç»“åˆ Linux çš„ `crontab` æˆ– macOS çš„ `launchd`ã€‚ä¾‹å¦‚ï¼Œæ¯å¤©æ—©æ™¨ 9 ç‚¹è¿è¡Œè„šæœ¬ï¼Œè‡ªåŠ¨åœ¨æ»´ç­”æ¸…å•ä¸­ç”Ÿæˆå½“å¤©çš„ä¾‹è¡Œæ£€æŸ¥æ¸…å•ã€‚
2. **ç»“åˆ CI/CD æµç¨‹**
   åœ¨ GitHub Actions æˆ– GitLab CI ä¸­ï¼Œå½“ä»£ç æ„å»ºå¤±è´¥æ—¶ï¼Œä¸ä»…é€šè¿‡é‚®ä»¶æŠ¥è­¦ï¼Œè¿˜ç›´æ¥åœ¨è´Ÿè´£äººçš„æ»´ç­”æ¸…å•ä¸­æ’å…¥ä¸€æ¡é«˜ä¼˜å…ˆçº§å¾…åŠä»»åŠ¡ã€‚
3. **RSS / é‚®ä»¶è§£æå…¥åº“**
   ç¼–å†™ä¸€ä¸ªå‰ç½®è„šæœ¬ç›‘å¬ç‰¹å®šçš„é‚®ä»¶æˆ– RSS è®¢é˜…æºï¼Œæå–æ ‡é¢˜å’Œæ‘˜è¦åï¼Œåˆ©ç”¨æ­¤å·¥å…·ä¸€é”®æ¨é€åˆ°æ»´ç­”æ¸…å•ä½œä¸ºç¨åé˜…è¯»ä»»åŠ¡ã€‚
4. **å¢å¼ºå‚æ•°è§£æ**
   åç»­å¯ä¿®æ”¹ Python è„šæœ¬çš„ `argparse` éƒ¨åˆ†ï¼Œå¢åŠ è¯¸å¦‚ `--project-id`ï¼ˆåŠ¨æ€åˆ‡æ¢æ¸…å•åˆ†ç»„é€šè¿‡å‚æ•°ä¼ å…¥ï¼‰ã€`--due-time`ï¼ˆæŒ‡å®šç²¾ç¡®åˆ°åˆ†é’Ÿçš„æˆªæ­¢æ—¶é—´ï¼‰ç­‰é«˜çº§å‚æ•°ã€‚

# ä¸»è¦å‚è€ƒ

- [æ»´ç­”æ¸…å•ï¼ˆDida365ï¼‰å®˜æ–¹ Open API æ–‡æ¡£](https://developer.dida365.com/docs#/openapi)
